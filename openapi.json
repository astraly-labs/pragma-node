{"openapi":"3.1.0","info":{"title":"pragma-node","description":"","license":{"name":""},"version":"0.1.0"},"servers":[{"url":"https://{environment}.pragma.build","variables":{"environment":{"default":"api.devnet"}}}],"paths":{"/node/v1/aggregation/candlestick/{base}/{quote}":{"get":{"tags":["Market Data"],"operationId":"get_ohlc","parameters":[{"name":"base","in":"path","description":"Base asset symbol","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote asset symbol","required":true,"schema":{"type":"string"}},{"name":"timestamp","in":"query","description":"The unix timestamp in seconds to retrieve historical price data.\nThis endpoint will return the first update whose timestamp is <= the provided value.\n\nIf not provided, returns the latest available price.\n\n# Examples\n- `1_647_820_800`: Returns price data from March 21, 2022 00:00:00 UTC\n- `null`: Returns the most recent price update\n\nNOTE: This only works for `median` aggregation","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/i64"}]}},{"name":"interval","in":"query","description":"Time interval for aggregated price data. Different intervals affect how price data is\naggregated and can be used to get OHLC (Open/High/Low/Close) data at various timeframes.\n\n# Available intervals\n- `100ms`: 100 milliseconds - High frequency trading\n- `1s`: 1 second - Real-time trading\n- `5s`: 5 seconds - Short-term price movements\n- `1min`: 1 minute - Intraday trading\n- `15min`: 15 minutes - Medium-term analysis\n- `1h`: 1 hour - Daily trading patterns\n- `2h`: 2 hours (default) - Extended market analysis\n- `1d`: 1 day - Long-term trends\n- `1w`: 1 week - Strategic market overview","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/Interval"}]}},{"name":"routing","in":"query","description":"Enable price routing through intermediate pairs.\nWhen true, if a direct price for the requested pair is not available,\nthe system will attempt to calculate it using intermediate pairs.\n\n# Example\nFor BTC/EUR when routing is enabled:\n- If direct BTC/EUR price is unavailable\n- System might route through BTC/USD and EUR/USD\n\nDefault: true","required":false,"schema":{"type":["boolean","null"]}},{"name":"aggregation","in":"query","description":"Method used to aggregate prices from multiple sources.\n\n# Available modes\n- `median`: Middle value (default, more manipulation resistant)\n- `mean`: Average of all values\n- `twap`: Time-Weighted Average Price","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/AggregationMode"}]}},{"name":"entry_type","in":"query","description":"Type of market entry to retrieve\n\n# Available types\n- `spot`: Spot market prices (default)\n- `perp`: Perpetual futures prices\n- `future`: Fixed-expiry futures prices","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/EntryType"}]}},{"name":"expiry","in":"query","description":"Expiry date for future contracts in ISO 8601 format.\nOnly applicable when `entry_type` is \"future\".\n\n# Example\n- `\"2024-12-31\"`: December 31, 2024 expiry\n- `null`: Not applicable for spot/perp markets","required":false,"schema":{"type":["string","null"]}},{"name":"with_components","in":"query","description":"Include source components in the response.\nWhen true, the response will include price data from individual sources.\n\n# Example\n- `true`: Include source breakdown in response\n- `false`: Return aggregated data only (default)","required":false,"schema":{"type":["boolean","null"]}}],"responses":{"200":{"description":"Successfully retrieved OHLC data","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetOHLCResponse"},"example":{"data":[{"close":"82208749021850000000000","high":"82289627995410000000000","low":"82023393045000000000000","open":"82069269773700000000000","time":"2025-03-10T07:30:00"}],"pair_id":"BTC/USD"}}}},"400":{"description":"Invalid parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"},"example":{"happened_at":"2025-03-10T08:27:29.324879945Z","message":"Invalid timestamp: Timestamp range error: End timestamp is in the future","resource":"EntryModel"}}}},"404":{"description":"No data found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"},"example":{"happened_at":"2025-03-10T08:27:29.324879945Z","message":"Entry not found","resource":"EntryModel"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"},"example":{"happened_at":"2025-03-10T08:27:29.324879945Z","message":"Database error: connection failed","resource":"EntryModel"}}}}},"security":[{"api_key":[]}]}},"/node/v1/data/multi/stream":{"get":{"tags":["Stream"],"operationId":"stream_entry_multi_pair","parameters":[{"name":"get_entry_params","in":"query","description":"Base parameters for entry requests including interval, aggregation mode, and routing options","required":true,"schema":{"$ref":"#/components/schemas/GetEntryParams"}},{"name":"pairs[]","in":"query","description":"List of trading pairs to stream prices for (e.g. `[\"ETH/USD\", \"BTC/USD\"]`)","required":true,"schema":{"type":"array","items":{"type":"string"}},"example":["ETH/USD","BTC/USD"]},{"name":"historical_prices","in":"query","description":"Number of historical price entries to fetch on initial connection (default: 100)","required":false,"schema":{"type":["integer","null"],"minimum":0},"example":100}],"responses":{"200":{"description":"Server-sent events stream of price entries for multiple pairs","content":{"text/event-stream":{}}}}}},"/node/v1/data/publish":{"post":{"tags":["crate::handlers::create_entry"],"operationId":"create_entries","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateEntryRequest"}}},"required":true},"responses":{"200":{"description":"Entries published successfuly","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateEntryResponse"}}}},"401":{"description":"Unauthorized Publisher","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}}}}},"/node/v1/data/publish_future":{"post":{"tags":["crate::handlers::create_future_entry"],"operationId":"create_future_entries","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateFutureEntryRequest"}}},"required":true},"responses":{"200":{"description":"Entries published successfuly","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CreateFutureEntryResponse"}}}},"401":{"description":"Unauthorized Publisher","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}}}}},"/node/v1/data/subscribe":{"get":{"tags":["StarkEx Oracle"],"operationId":"subscribe_to_entry","responses":{"101":{"description":"WebSocket connection upgraded successfully"},"403":{"description":"Forbidden - Rate limit exceeded","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"},"example":{"error":"Locked: Pragma signer not found"}}}}}}},"/node/v1/data/{base}/{quote}":{"get":{"tags":["Price Data"],"summary":"Get the latest price entry for a trading pair","operationId":"get_entry","parameters":[{"name":"base","in":"path","description":"Base asset symbol (e.g. BTC)","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote asset symbol (e.g. USD)","required":true,"schema":{"type":"string"}},{"name":"timestamp","in":"query","description":"The unix timestamp in seconds to retrieve historical price data.\nThis endpoint will return the first update whose timestamp is <= the provided value.\n\nIf not provided, returns the latest available price.\n\n# Examples\n- `1_647_820_800`: Returns price data from March 21, 2022 00:00:00 UTC\n- `null`: Returns the most recent price update\n\nNOTE: This only works for `median` aggregation","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/i64"}]}},{"name":"interval","in":"query","description":"Time interval for aggregated price data. Different intervals affect how price data is\naggregated and can be used to get OHLC (Open/High/Low/Close) data at various timeframes.\n\n# Available intervals\n- `100ms`: 100 milliseconds - High frequency trading\n- `1s`: 1 second - Real-time trading\n- `5s`: 5 seconds - Short-term price movements\n- `1min`: 1 minute - Intraday trading\n- `15min`: 15 minutes - Medium-term analysis\n- `1h`: 1 hour - Daily trading patterns\n- `2h`: 2 hours (default) - Extended market analysis\n- `1d`: 1 day - Long-term trends\n- `1w`: 1 week - Strategic market overview","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/Interval"}]}},{"name":"routing","in":"query","description":"Enable price routing through intermediate pairs.\nWhen true, if a direct price for the requested pair is not available,\nthe system will attempt to calculate it using intermediate pairs.\n\n# Example\nFor BTC/EUR when routing is enabled:\n- If direct BTC/EUR price is unavailable\n- System might route through BTC/USD and EUR/USD\n\nDefault: true","required":false,"schema":{"type":["boolean","null"]}},{"name":"aggregation","in":"query","description":"Method used to aggregate prices from multiple sources.\n\n# Available modes\n- `median`: Middle value (default, more manipulation resistant)\n- `mean`: Average of all values\n- `twap`: Time-Weighted Average Price","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/AggregationMode"}]}},{"name":"entry_type","in":"query","description":"Type of market entry to retrieve\n\n# Available types\n- `spot`: Spot market prices (default)\n- `perp`: Perpetual futures prices\n- `future`: Fixed-expiry futures prices","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/EntryType"}]}},{"name":"expiry","in":"query","description":"Expiry date for future contracts in ISO 8601 format.\nOnly applicable when `entry_type` is \"future\".\n\n# Example\n- `\"2024-12-31\"`: December 31, 2024 expiry\n- `null`: Not applicable for spot/perp markets","required":false,"schema":{"type":["string","null"]}},{"name":"with_components","in":"query","description":"Include source components in the response.\nWhen true, the response will include price data from individual sources.\n\n# Example\n- `true`: Include source breakdown in response\n- `false`: Return aggregated data only (default)","required":false,"schema":{"type":["boolean","null"]}}],"responses":{"200":{"description":"Successfully retrieved price entry","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetEntryResponse"},"example":{"components":[{"price":"0x6cc61113f5871b1000","source":"BINANCE","timestamp":1743082057}],"decimals":18,"num_sources_aggregated":5,"pair_id":"BTC/USD","price":"0x1234567890abcdef","timestamp":1647820800}}}},"400":{"description":"Invalid request parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}},"404":{"description":"Price entry not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}},"500":{"description":"Internal server error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/EntryError"}}}}},"security":[{"api_key":[]}]}},"/node/v1/data/{base}/{quote}/future_expiries":{"get":{"tags":["crate::handlers::get_expiries"],"operationId":"get_expiries","parameters":[{"name":"base","in":"path","description":"Base Asset","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote Asset","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"Get available future expiries for a pair","content":{"application/json":{"schema":{"type":"array","items":{"type":"array","items":{"type":"string","format":"date-time"}}}}}}}}},"/node/v1/onchain/checkpoints/{base}/{quote}":{"get":{"tags":["crate::handlers::onchain::get_checkpoints"],"operationId":"get_onchain_checkpoints","parameters":[{"name":"base","in":"path","description":"Base Asset","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote Asset","required":true,"schema":{"type":"string"}},{"name":"network","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Network"}},{"name":"limit","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int64","minimum":0}}],"responses":{"200":{"description":"Get the onchain checkpoints for a pair","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetOnchainCheckpointsResponse"}}}}}}},"/node/v1/onchain/history/{base}/{quote}":{"get":{"tags":["crate::handlers::onchain::get_history"],"operationId":"get_onchain_history","parameters":[{"name":"base","in":"path","description":"Base Asset","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote Asset","required":true,"schema":{"type":"string"}},{"name":"network","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Network"}},{"name":"timestamp","in":"query","required":true,"schema":{"$ref":"#/components/schemas/TimestampRange"}},{"name":"chunk_interval","in":"query","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/Interval"}]}},{"name":"routing","in":"query","required":false,"schema":{"type":["boolean","null"]}}],"responses":{"200":{"description":"Get the historical onchain median price","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetOnchainHistoryResponse"}}}}}}},"/node/v1/onchain/publishers":{"get":{"tags":["crate::handlers::onchain::get_publishers"],"operationId":"get_onchain_publishers","parameters":[{"name":"network","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Network"}},{"name":"data_type","in":"query","required":true,"schema":{"$ref":"#/components/schemas/DataType"}}],"responses":{"200":{"description":"Get the onchain publishers","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetOnchainPublishersResponse"}}}}}}},"/node/v1/onchain/{base}/{quote}":{"get":{"tags":["crate::handlers::onchain::get_entry"],"operationId":"get_onchain_entry","parameters":[{"name":"base","in":"path","description":"Base Asset","required":true,"schema":{"type":"string"}},{"name":"quote","in":"path","description":"Quote Asset","required":true,"schema":{"type":"string"}},{"name":"network","in":"query","required":true,"schema":{"$ref":"#/components/schemas/Network"}},{"name":"aggregation","in":"query","required":false,"schema":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/AggregationMode"}]}},{"name":"routing","in":"query","required":false,"schema":{"type":["boolean","null"]}},{"name":"timestamp","in":"query","required":false,"schema":{"type":["integer","null"],"format":"int64"}},{"name":"components","in":"query","required":false,"schema":{"type":["boolean","null"]}},{"name":"variations","in":"query","required":false,"schema":{"type":["boolean","null"]}}],"responses":{"200":{"description":"Get the onchain entry","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetOnchainEntryResponse"}}}}}}}},"components":{"schemas":{"AggregationMode":{"type":"string","enum":["median","twap"]},"AssetOraclePrice":{"type":"object","description":"Price data structure for `StarkEx` oracle integration","required":["global_asset_id","median_price","signature","signed_prices"],"properties":{"global_asset_id":{"type":"string","description":"Global asset identifier in `StarkEx` hex format\nFormat: <ASSET>-<CURRENCY>-<DECIMALS>00..00","example":"0x534f4c2d5553442d38000000000000"},"median_price":{"type":"string","description":"Median price in `StarkEx` 18 decimals format","example":"128065038090000007168"},"signature":{"type":"string","description":"Pragma's signature of the price data in `StarkEx` format","example":"0x02ba39e956bb5b29a0fab31d61c7678228f79dddee2998b4ff3de5c7a6ae1e770636712af81b0506749555e1439004b4ce905419d2ba946b9bd06eb87de7a167"},"signed_prices":{"type":"array","items":{"$ref":"#/components/schemas/SignedPublisherPrice"},"description":"Individual signed prices from publishers"}}},"BaseEntry":{"type":"object","required":["timestamp","source","publisher"],"properties":{"publisher":{"type":"string"},"source":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}},"Checkpoint":{"type":"object","required":["tx_hash","price","timestamp","sender_address"],"properties":{"price":{"type":"string"},"sender_address":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0},"tx_hash":{"type":"string"}}},"ConversionError":{"oneOf":[{"type":"string","enum":["FailedSerialization"]},{"type":"string","enum":["InvalidDateTime"]},{"type":"string","enum":["BigDecimalConversion"]},{"type":"string","enum":["FeltConversion"]},{"type":"string","enum":["U128Conversion"]},{"type":"string","enum":["StringTimestampConversion"]},{"type":"string","enum":["StringPriceConversion"]},{"type":"object","required":["FailedSignature"],"properties":{"FailedSignature":{"type":"string"}}}]},"CreateEntryRequest":{"type":"object","required":["signature","entries"],"properties":{"entries":{"type":"array","items":{"$ref":"#/components/schemas/Entry"}},"signature":{"type":"array","items":{"type":"string"}}}},"CreateEntryResponse":{"type":"object","required":["number_entries_created"],"properties":{"number_entries_created":{"type":"integer","minimum":0}}},"CreateFutureEntryRequest":{"type":"object","required":["signature","entries"],"properties":{"entries":{"type":"array","items":{"$ref":"#/components/schemas/FutureEntry"}},"signature":{"type":"array","items":{"type":"string"}}}},"CreateFutureEntryResponse":{"type":"object","required":["number_entries_created"],"properties":{"number_entries_created":{"type":"integer","minimum":0}}},"DataType":{"type":"string","enum":["spot_entry","perp_entry","future_entry"]},"Entry":{"type":"object","required":["base","pair_id","price","volume"],"properties":{"base":{"$ref":"#/components/schemas/BaseEntry"},"pair_id":{"type":"string"},"price":{"type":"integer","minimum":0},"volume":{"type":"integer","minimum":0}}},"EntryComponent":{"type":"object","required":["source","price","timestamp"],"properties":{"price":{"type":"string"},"source":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}},"EntryError":{"oneOf":[{"type":"object","required":["InvalidSignature"],"properties":{"InvalidSignature":{"$ref":"#/components/schemas/SignerError"}},"example":"invalid signature"},{"type":"object","required":["InvalidTimestamp"],"properties":{"InvalidTimestamp":{"$ref":"#/components/schemas/TimestampError"}},"example":"invalid timestamp"},{"type":"string","enum":["InvalidExpiry"],"example":"invalid expiry"},{"type":"object","required":["InvalidInterval"],"properties":{"InvalidInterval":{"type":"array","items":{"type":"object"},"maxItems":2,"minItems":2}},"example":"unsupported interval 1s for aggregation median"},{"type":"object","required":["InvalidOnchainInterval"],"properties":{"InvalidOnchainInterval":{"$ref":"#/components/schemas/Interval"}},"example":"unsupported interval 1s for onchain data"},{"type":"object","required":["InvalidLoginMessage"],"properties":{"InvalidLoginMessage":{"type":"string"}}},{"type":"object","required":["InvalidDataTypeForNetwork"],"properties":{"InvalidDataTypeForNetwork":{"type":"array","items":{"type":"object"},"maxItems":2,"minItems":2}}},{"type":"object","required":["Unauthorized"],"properties":{"Unauthorized":{"type":"string"}}},{"type":"object","required":["PairNotFound"],"properties":{"PairNotFound":{"type":"string"}}},{"type":"object","required":["EntryNotFound"],"properties":{"EntryNotFound":{"type":"string"}}},{"type":"object","required":["PublisherNotFound"],"properties":{"PublisherNotFound":{"type":"string"}}},{"type":"object","required":["RouteNotFound"],"properties":{"RouteNotFound":{"type":"string"}}},{"type":"string","enum":["HistoryNotFound"]},{"type":"object","required":["PublisherError"],"properties":{"PublisherError":{"$ref":"#/components/schemas/PublisherError"}}},{"type":"object","required":["PublishData"],"properties":{"PublishData":{"type":"string"}}},{"type":"object","required":["BuildPublish"],"properties":{"BuildPublish":{"type":"string"}}},{"type":"string","enum":["InvalidSigner"]},{"type":"object","required":["DatabaseError"],"properties":{"DatabaseError":{"type":"string"}}},{"type":"object","required":["InternalServerError"],"properties":{"InternalServerError":{"type":"string"}}},{"type":"object","required":["WebSocketError"],"properties":{"WebSocketError":{"$ref":"#/components/schemas/WebSocketError"}}}],"example":{"code":"UNAUTHORIZED","message":"Unauthorized request: Invalid API key","timestamp":"2024-03-20T10:30:00Z"}},"EntryType":{"type":"string","enum":["spot","perp","future"]},"FutureEntry":{"type":"object","required":["base","pair_id","price","volume","expiration_timestamp"],"properties":{"base":{"$ref":"#/components/schemas/BaseEntry"},"expiration_timestamp":{"type":"integer","format":"int64","minimum":0},"pair_id":{"type":"string"},"price":{"type":"integer","minimum":0},"volume":{"type":"integer","minimum":0}}},"GetEntryParams":{"type":"object","description":"Parameters for retrieving price entries","required":["timestamp"],"properties":{"aggregation":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/AggregationMode","description":"Method used to aggregate prices from multiple sources.\n\n# Available modes\n- `median`: Middle value (default, more manipulation resistant)\n- `mean`: Average of all values\n- `twap`: Time-Weighted Average Price"}]},"entry_type":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/EntryType","description":"Type of market entry to retrieve\n\n# Available types\n- `spot`: Spot market prices (default)\n- `perp`: Perpetual futures prices\n- `future`: Fixed-expiry futures prices"}]},"expiry":{"type":["string","null"],"description":"Expiry date for future contracts in ISO 8601 format.\nOnly applicable when `entry_type` is \"future\".\n\n# Example\n- `\"2024-12-31\"`: December 31, 2024 expiry\n- `null`: Not applicable for spot/perp markets","example":"2024-12-31"},"interval":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/Interval","description":"Time interval for aggregated price data. Different intervals affect how price data is\naggregated and can be used to get OHLC (Open/High/Low/Close) data at various timeframes.\n\n# Available intervals\n- `100ms`: 100 milliseconds - High frequency trading\n- `1s`: 1 second - Real-time trading\n- `5s`: 5 seconds - Short-term price movements\n- `1min`: 1 minute - Intraday trading\n- `15min`: 15 minutes - Medium-term analysis\n- `1h`: 1 hour - Daily trading patterns\n- `2h`: 2 hours (default) - Extended market analysis\n- `1d`: 1 day - Long-term trends\n- `1w`: 1 week - Strategic market overview"}]},"routing":{"type":["boolean","null"],"description":"Enable price routing through intermediate pairs.\nWhen true, if a direct price for the requested pair is not available,\nthe system will attempt to calculate it using intermediate pairs.\n\n# Example\nFor BTC/EUR when routing is enabled:\n- If direct BTC/EUR price is unavailable\n- System might route through BTC/USD and EUR/USD\n\nDefault: true","example":true},"timestamp":{"type":"integer","format":"int64","description":"The unix timestamp in seconds to retrieve historical price data.\nThis endpoint will return the first update whose timestamp is <= the provided value.\n\nIf not provided, returns the latest available price.\n\n# Examples\n- `1_647_820_800`: Returns price data from March 21, 2022 00:00:00 UTC\n- `null`: Returns the most recent price update\n\nNOTE: This only works for `median` aggregation","example":1647820800},"with_components":{"type":["boolean","null"],"description":"Include source components in the response.\nWhen true, the response will include price data from individual sources.\n\n# Example\n- `true`: Include source breakdown in response\n- `false`: Return aggregated data only (default)","example":false}}},"GetEntryResponse":{"type":"object","required":["num_sources_aggregated","pair_id","price","timestamp","decimals"],"properties":{"components":{"type":["array","null"],"items":{"$ref":"#/components/schemas/EntryComponent"}},"decimals":{"type":"integer","format":"int32","minimum":0},"num_sources_aggregated":{"type":"integer","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}},"GetOHLCResponse":{"type":"object","description":"Response containing OHLC (candlestick) data for a trading pair","required":["pair_id","data"],"properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/OHLCEntry"},"description":"Array of OHLC entries ordered by timestamp"},"pair_id":{"type":"string","description":"Trading pair identifier (e.g., \"BTC/USD\")"}},"example":{"data":[{"close":"82208749021850000000000","high":"82289627995410000000000","low":"82023393045000000000000","open":"82069269773700000000000","time":"2025-03-10T07:30:00"}],"pair_id":"BTC/USD"}},"GetOnchainCheckpointsParams":{"type":"object","required":["network"],"properties":{"limit":{"type":["integer","null"],"format":"int64","minimum":0},"network":{"$ref":"#/components/schemas/Network"}}},"GetOnchainCheckpointsResponse":{"type":"array","items":{"$ref":"#/components/schemas/Checkpoint"}},"GetOnchainEntryParams":{"type":"object","required":["network"],"properties":{"aggregation":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/AggregationMode"}]},"components":{"type":["boolean","null"]},"network":{"$ref":"#/components/schemas/Network"},"routing":{"type":["boolean","null"]},"timestamp":{"type":["integer","null"],"format":"int64"},"variations":{"type":["boolean","null"]}}},"GetOnchainEntryResponse":{"type":"object","required":["pair_id","last_updated_timestamp","price","decimals","nb_sources_aggregated","asset_type"],"properties":{"asset_type":{"type":"string"},"components":{"type":["array","null"],"items":{"$ref":"#/components/schemas/OnchainEntry"}},"decimals":{"type":"integer","format":"int32","minimum":0},"last_updated_timestamp":{"type":"integer","format":"int64","minimum":0},"nb_sources_aggregated":{"type":"integer","format":"int32","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"},"variations":{"type":["object","null"],"additionalProperties":{"type":"number","format":"float"},"propertyNames":{"type":"string","enum":["100ms","1s","5s","10s","1min","5min","15min","1h","2h","1d","1w"]}}}},"GetOnchainHistoryEntry":{"type":"object","required":["pair_id","timestamp","median_price","decimals","nb_sources_aggregated"],"properties":{"decimals":{"type":"integer","format":"int32","minimum":0},"median_price":{"type":"string"},"nb_sources_aggregated":{"type":"integer","format":"int32","minimum":0},"pair_id":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}},"GetOnchainHistoryParams":{"type":"object","required":["network","timestamp"],"properties":{"chunk_interval":{"oneOf":[{"type":"null"},{"$ref":"#/components/schemas/Interval"}]},"network":{"$ref":"#/components/schemas/Network"},"routing":{"type":["boolean","null"]},"timestamp":{"$ref":"#/components/schemas/TimestampRange"}}},"GetOnchainHistoryResponse":{"type":"array","items":{"$ref":"#/components/schemas/GetOnchainHistoryEntry"}},"GetOnchainOHLCResponse":{"type":"object","required":["pair_id","data"],"properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/OHLCEntry"}},"pair_id":{"type":"string"}}},"GetOnchainPublishersParams":{"type":"object","required":["network","data_type"],"properties":{"data_type":{"$ref":"#/components/schemas/DataType"},"network":{"$ref":"#/components/schemas/Network"}}},"GetOnchainPublishersResponse":{"type":"array","items":{"$ref":"#/components/schemas/Publisher"}},"Interval":{"type":"string","enum":["100ms","1s","5s","10s","1min","5min","15min","1h","2h","1d","1w"]},"LoginMessage":{"type":"object","required":["signature","publisher_name","expiration_timestamp"],"properties":{"expiration_timestamp":{"type":"integer","format":"int64","minimum":0},"publisher_name":{"type":"string"},"signature":{"type":"array","items":{"type":"string"}}}},"MarketEntry":{"oneOf":[{"type":"object","required":["data","type"],"properties":{"data":{"$ref":"#/components/schemas/Entry"},"type":{"type":"string","enum":["spot"]}}},{"type":"object","required":["data","type"],"properties":{"data":{"$ref":"#/components/schemas/PerpEntry"},"type":{"type":"string","enum":["perp"]}}}]},"Network":{"type":"string","enum":["sepolia","mainnet"]},"OHLCEntry":{"type":"object","required":["time","open","low","high","close"],"properties":{"close":{"type":"integer","format":"int64","minimum":0},"high":{"type":"integer","format":"int64","minimum":0},"low":{"type":"integer","format":"int64","minimum":0},"open":{"type":"integer","format":"int64","minimum":0},"time":{"type":"string","format":"date-time"}}},"OnchainEntry":{"type":"object","required":["publisher","source","price","tx_hash","timestamp"],"properties":{"price":{"type":"string"},"publisher":{"type":"string"},"source":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0},"tx_hash":{"type":"string"}}},"Pair":{"type":"object","description":"A pair of assets, e.g. BTC/USD\n\nThis is a simple struct that holds the base and quote assets.\nIt is used to represent a pair of assets in the system.\nBase and quote are always in UPPERCASE.","required":["base","quote"],"properties":{"base":{"type":"string"},"quote":{"type":"string"}}},"PerpEntry":{"type":"object","required":["base","pair_id","price","volume"],"properties":{"base":{"$ref":"#/components/schemas/BaseEntry"},"pair_id":{"type":"string"},"price":{"type":"integer","minimum":0},"volume":{"type":"integer","minimum":0}}},"PublishEntryRequest":{"type":"object","required":["entries"],"properties":{"entries":{"type":"array","items":{"$ref":"#/components/schemas/MarketEntry"}}}},"Publisher":{"type":"object","required":["publisher","website_url","type","nb_feeds","daily_updates","total_updates","components"],"properties":{"components":{"type":"array","items":{"$ref":"#/components/schemas/PublisherEntry"}},"daily_updates":{"type":"integer","format":"int32","minimum":0},"last_updated_timestamp":{"type":["integer","null"],"format":"int64","minimum":0},"nb_feeds":{"type":"integer","format":"int32","minimum":0},"publisher":{"type":"string"},"total_updates":{"type":"integer","format":"int32","minimum":0},"type":{"type":"integer","format":"int32","minimum":0},"website_url":{"type":"string"}}},"PublisherEntry":{"type":"object","required":["pair_id","last_updated_timestamp","price","source","decimals","daily_updates"],"properties":{"daily_updates":{"type":"integer","format":"int32","minimum":0},"decimals":{"type":"integer","format":"int32","minimum":0},"last_updated_timestamp":{"type":"integer","format":"int64","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"},"source":{"type":"string"}}},"PublisherError":{"oneOf":[{"type":"object","required":["InvalidKey"],"properties":{"InvalidKey":{"type":"string"}}},{"type":"object","required":["InvalidAddress"],"properties":{"InvalidAddress":{"type":"string"}}},{"type":"object","required":["InactivePublisher"],"properties":{"InactivePublisher":{"type":"string"}}},{"type":"string","enum":["NotFound"]},{"type":"string","enum":["InternalServerError"]}]},"RedisError":{"oneOf":[{"type":"string","enum":["InternalServerError"]},{"type":"string","enum":["Connection"]},{"type":"object","required":["OptionNotFound"],"properties":{"OptionNotFound":{"type":"array","items":{"type":"object"},"maxItems":2,"minItems":2}}},{"type":"object","required":["MerkleTreeNotFound"],"properties":{"MerkleTreeNotFound":{"type":"integer","format":"int64","minimum":0}}},{"type":"object","required":["InvalidOptionHash"],"properties":{"InvalidOptionHash":{"type":"string"}}},{"type":"string","enum":["TreeDeserialization"]},{"type":"object","required":["NoBlocks"],"properties":{"NoBlocks":{"type":"string"}}}]},"SignedPublisherPrice":{"type":"object","description":"Response format for `StarkEx` price subscriptions","required":["oracle_asset_id","oracle_price","signing_key","timestamp"],"properties":{"oracle_asset_id":{"type":"string","description":"StarkEx-specific asset identifier in hex format\nFormat: <ASSET><CURRENCY>00..00PRAGMA00","example":"0x534f4c55534400000000000000000000505241474d4100"},"oracle_price":{"type":"string","description":"Price in `StarkEx` 18 decimals","example":"128065038090000000000"},"signing_key":{"type":"string","description":"Public key of the price signer (Pragma's `StarkEx` key)","example":"0x624EBFB99865079BD58CFCFB925B6F5CE940D6F6E41E118B8A72B7163FB435C"},"timestamp":{"type":"string","description":"Unix timestamp as string","example":"1741594457"}}},"SignerError":{"oneOf":[{"type":"object","required":["ConversionError"],"properties":{"ConversionError":{"$ref":"#/components/schemas/ConversionError"}}},{"type":"object","required":["SigningError"],"properties":{"SigningError":{"type":"string"}}},{"type":"object","required":["InvalidSignature"],"properties":{"InvalidSignature":{"type":"string"}}},{"type":"object","required":["Unauthorized"],"properties":{"Unauthorized":{"type":"string"}}},{"type":"object","required":["InvalidMessage"],"properties":{"InvalidMessage":{"type":"string"}}}]},"StreamEntryMultipairParams":{"allOf":[{"$ref":"#/components/schemas/GetEntryParams","description":"Base parameters for entry requests including interval, aggregation mode, and routing options"},{"type":"object","required":["pairs[]"],"properties":{"historical_prices":{"type":["integer","null"],"description":"Number of historical price entries to fetch on initial connection (default: 100)","minimum":0},"pairs[]":{"type":"array","items":{"type":"string"},"description":"List of trading pairs to stream prices for (e.g. `[\"ETH/USD\", \"BTC/USD\"]`)"}}}]},"SubscribeToEntryResponse":{"type":"object","description":"WebSocket response message for `StarkEx` price updates","required":["oracle_prices","timestamp"],"properties":{"oracle_prices":{"type":"array","items":{"$ref":"#/components/schemas/AssetOraclePrice"},"description":"Array of price data for subscribed assets"},"timestamp":{"type":"integer","format":"int64","description":"Unix timestamp of the update","example":1741594458}},"example":{"oracle_prices":[{"global_asset_id":"0x534f4c2d5553442d38000000000000","median_price":"128065038090000007168","signature":"0x02ba39e956bb5b29a0fab31d61c7678228f79dddee2998b4ff3de5c7a6ae1e770636712af81b0506749555e1439004b4ce905419d2ba946b9bd06eb87de7a167","signed_prices":[{"oracle_asset_id":"0x534f4c55534400000000000000000000505241474d4100","oracle_price":"128065038090000000000","signing_key":"0x624EBFB99865079BD58CFCFB925B6F5CE940D6F6E41E118B8A72B7163FB435C","timestamp":"1741594457"}]}],"timestamp":1741594458}},"SubscribeToPriceResponse":{"type":"object","required":["oracle_prices","timestamp"],"properties":{"oracle_prices":{"type":"array","items":{"$ref":"#/components/schemas/AssetOraclePrice"}},"timestamp":{"type":"integer","format":"int64"}}},"TimestampError":{"oneOf":[{"type":"object","required":["RangeError"],"properties":{"RangeError":{"$ref":"#/components/schemas/TimestampRangeError"}}},{"type":"object","required":["ToDatetimeErrorU64"],"properties":{"ToDatetimeErrorU64":{"type":"integer","format":"int64","minimum":0}}},{"type":"object","required":["ToDatetimeErrorI64"],"properties":{"ToDatetimeErrorI64":{"type":"integer","format":"int64"}}},{"type":"object","required":["Other"],"properties":{"Other":{"type":"string"}}}]},"TimestampRange":{"type":"string","description":"Represents a range of timestamps"},"TimestampRangeError":{"oneOf":[{"type":"string","enum":["StartAfterEnd"]},{"type":"string","enum":["EndInFuture"]},{"type":"string","enum":["StartEqualsEnd"]},{"type":"string","enum":["ConversionError"]},{"type":"object","required":["Other"],"properties":{"Other":{"type":"string"}}}]},"WebSocketError":{"oneOf":[{"type":"string","enum":["ChannelInit"]},{"type":"object","required":["MessageDecode"],"properties":{"MessageDecode":{"type":"string"}}},{"type":"string","enum":["ChannelClose"]}]}},"responses":{"AssetOraclePrice":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["num_sources_aggregated","pair_id","price"],"properties":{"num_sources_aggregated":{"type":"integer","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"}}}}}},"CreateEntryResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["number_entries_created"],"properties":{"number_entries_created":{"type":"integer","minimum":0}}}}}},"CreateFutureEntryResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["number_entries_created"],"properties":{"number_entries_created":{"type":"integer","minimum":0}}}}}},"EntryComponent":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["source","price","timestamp"],"properties":{"price":{"type":"string"},"source":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}}}}},"GetEntryResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["num_sources_aggregated","pair_id","price","timestamp","decimals"],"properties":{"components":{"type":["array","null"],"items":{"$ref":"#/components/schemas/EntryComponent"}},"decimals":{"type":"integer","format":"int32","minimum":0},"num_sources_aggregated":{"type":"integer","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"},"timestamp":{"type":"integer","format":"int64","minimum":0}}}}}},"GetOHLCResponse":{"description":"Response containing OHLC (candlestick) data for a trading pair","content":{"application/json":{"schema":{"type":"object","description":"Response containing OHLC (candlestick) data for a trading pair","required":["pair_id","data"],"properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/OHLCEntry"},"description":"Array of OHLC entries ordered by timestamp"},"pair_id":{"type":"string","description":"Trading pair identifier (e.g., \"BTC/USD\")"}}}}}},"GetOnchainCheckpointsResponse":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Checkpoint"}}}}},"GetOnchainEntryResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["pair_id","last_updated_timestamp","price","decimals","nb_sources_aggregated","asset_type"],"properties":{"asset_type":{"type":"string"},"components":{"type":["array","null"],"items":{"$ref":"#/components/schemas/OnchainEntry"}},"decimals":{"type":"integer","format":"int32","minimum":0},"last_updated_timestamp":{"type":"integer","format":"int64","minimum":0},"nb_sources_aggregated":{"type":"integer","format":"int32","minimum":0},"pair_id":{"type":"string"},"price":{"type":"string"},"variations":{"type":["object","null"],"additionalProperties":{"type":"number","format":"float"},"propertyNames":{"type":"string","enum":["100ms","1s","5s","10s","1min","5min","15min","1h","2h","1d","1w"]}}}}}}},"GetOnchainHistoryResponse":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/GetOnchainHistoryEntry"}}}}},"GetOnchainOHLCResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["pair_id","data"],"properties":{"data":{"type":"array","items":{"$ref":"#/components/schemas/OHLCEntry"}},"pair_id":{"type":"string"}}}}}},"GetOnchainPublishersResponse":{"description":"","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/Publisher"}}}}},"SubscribeToEntryResponse":{"description":"WebSocket response message for `StarkEx` price updates","content":{"application/json":{"schema":{"type":"object","description":"WebSocket response message for `StarkEx` price updates","required":["oracle_prices","timestamp"],"properties":{"oracle_prices":{"type":"array","items":{"$ref":"#/components/schemas/AssetOraclePrice"},"description":"Array of price data for subscribed assets"},"timestamp":{"type":"integer","format":"int64","description":"Unix timestamp of the update","example":1741594458}}}}}},"SubscribeToPriceResponse":{"description":"","content":{"application/json":{"schema":{"type":"object","required":["oracle_prices","timestamp"],"properties":{"oracle_prices":{"type":"array","items":{"$ref":"#/components/schemas/AssetOraclePrice"}},"timestamp":{"type":"integer","format":"int64"}}}}}}},"securitySchemes":{"api_key":{"type":"apiKey","in":"header","name":"x-api-key"}}},"tags":[{"name":"pragma-node","description":"Pragma Node API"}]}